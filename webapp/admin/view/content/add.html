<script type="text/javascript" charset="utf-8" src="__JS__/ueditor/ueditor.config.js"></script>
<script type="text/javascript" charset="utf-8" src="__JS__/ueditor/ueditor.all.min.js">
</script>
<!--建议手动加在语言，避免在ie下有时因为加载语言失败导致编辑器加载失败-->
<!--这里加载的语言文件会覆盖你在配置项目里添加的语言类型，比如你在配置项目里配置的是英文，这里加载的中文，那最后就是中文-->
<script type="text/javascript" charset="utf-8" src="__JS__/ueditor/lang/zh-cn/zh-cn.js"></script>

<link type="text/css" rel="stylesheet" href="__JS__/bootstrap-fileinput/fileinput.css" />
<script type="text/javascript" src="__JS__/bootstrap-fileinput/fileinput.js"></script>
<script type="text/javascript" src="__JS__/bootstrap-fileinput/fileinput_locale_zh.js"></script>

<script type="text/javascript" src="__JS__/uploadImg.js"></script>

<style>
    .form-horizontal .control-label {
        width: 100px;
        text-align: left;
    }
    .col-md-offset-3 {
        margin-left: 5%;
    }
    .moreImgUpload{
        height:34px;
        line-height:34px;
        position: relative;
    }
    .moreImgUpload p{
        width: 100px;
        margin: 0;
        position: absolute;
    }
    .moreImgUpload input {
        width: 100px;
        opacity: 0;
    }
    #imgBoxSql{
        margin-top: 20px;
    }
    #imgBox div,
    #imgBoxSql div{
        float: left;
        margin-right: 20px;
    }
    #imgBox div img,
    #imgBoxSql div img{
        width: auto;
        height: 100px;
    }
    #imgBox div p,
    #imgBoxSql div p{
        text-align: center;
        cursor: pointer;
    }
    .close{display: none;}
</style>

<div class="page-bar margin-bottom-20">
    <ul class="page-breadcrumb">
        <li>
            <a href="{:url('admin/index/index')}">后台首页</a>
            <i class="fa fa-circle"></i>
        </li>
        <li>
            <span>内容管理</span>
            <i class="fa fa-circle"></i>
        </li>
        <li>
            <span>商城商品</span>
        </li>
    </ul>
</div>
<div class="row">
    <div class="col-md-12">
        <div class="portlet light bordered">
            <div class="portlet-title">
                <div class="caption">
					<span class="caption-subject bold uppercase">
						商城商品
					</span>
                </div>
            </div>
            <div class="portlet-body form">
                <form method="post" action="" class="form-horizontal" enctype="multipart/form-data">
                    <div class="form-body">
                        <div class="form-group">
                            <label class="col-md-3 control-label">商品类型</label>
                            <div class="col-md-9">
                                <select name="collage" class="form-control" onchange="if($(this).val() == 1){$('.collage').show()}else{$('.collage').hide()}" style="width:150px;display:unset;">
                                    <option value="0">普通商品</option>
                                    <option value="1">拼团商品</option>
                                </select>
                            </div>
                        </div>
						
						                        <div class="form-group">
                            <label class="col-md-3 control-label">是否新商品</label>
                            <div class="col-md-9">
                                <select name="is_xin" class="form-control" onchange="if($(this).val() == 1){$('.is_xin').show()}else{$('.is_xin').hide()}" style="width:150px;display:unset;">
                                    <option value="0">否</option>
                                    <option value="1">是</option>
                                </select>
                            </div>
                        </div>
						
						   <div class="form-group">
                            <label class="col-md-3 control-label">新产品订单数</label>
                            <div class="col-md-9">
                                <input type="text" name="xin_count" id="xin_count" value="" class="form-control">
                            </div>
                        </div>
						
						
                        <div class="form-group collage" style="display:none;">
                            <label class="col-md-3 control-label">拼团设置</label>
                            <div class="col-md-9">
                                <select name="collage_number" class="form-control" onchange="if($(this).val() == 5){$('.setup').show()}else{$('.setup').hide()}" style="width:150px;display:unset;">
                                    <option value="5">五人团</option>
                                    <option value="10">十人团</option>
                                </select>

                                <input type="number" step="1" name="collage_red_bag" placeholder="拼团失败，红包金额" onchange="if(this.value < 0){this.value = 0}" onclick="if(this.value < 0){this.value = 0}" class="form-control" style="width:200px;display:unset;">
                            </div>
                        </div>
						
						
												
						<div class="form-group collage">
                            <label class="col-md-3 control-label">2次拼团设置</label>
                            <div class="col-md-9">
                                <input type="text" value="2单订单鼓励金" class="form-control" style="width:150px;display:unset;" readonly>
                                <input type="number" step="1" name="collage_red_bag_xin" placeholder="拼团失败，红包金额" onchange="if(this.value < 0){this.value = 0}" onclick="if(this.value < 0){this.value = 0}" class="form-control" style="width:200px;display:unset;">
                            </div>
                        </div>
						
						
												
						                        <div class="form-group collage">
                            <label class="col-md-3 control-label">旧单拼团设置</label>
                            <div class="col-md-9">
                                <input type="text" value="5单订单鼓励金" class="form-control" style="width:150px;display:unset;" readonly>
                                <input type="number" step="1" name="collage_red_bag_jiu" placeholder="拼团失败，红包金额" onchange="if(this.value < 0){this.value = 0}" onclick="if(this.value < 0){this.value = 0}" class="form-control" style="width:200px;display:unset;">
                            </div>
                        </div>
						
						
						
                        <div class="form-group collage setup" style="display:none;">
                            <label class="col-md-3 control-label">返现设置</label>
                            <div class="col-md-9">
                                拼团成功 给上级
                                <input type="number" step="1" name="collage_money_a" value="" placeholder="" onchange="if(this.value < 0){this.value = 0}" onclick="if(this.value < 0){this.value = 0}" class="form-control" style="width:100px;display:unset;"> 元
                                &nbsp;
                                <!--                                给上上级-->
                                <!--                                <input type="number" step="1" name="collage_money_b" value="" placeholder="" onchange="if(this.value < 0){this.value = 0}" onclick="if(this.value < 0){this.value = 0}" class="form-control" style="width:100px;display:unset;"> 元-->
                                &nbsp;&nbsp;&nbsp;<br>
                                拼团失败 给上级
                                <input type="number" step="1" name="collage_money_c"  value="" placeholder="" onchange="if(this.value < 0){this.value = 0}" onclick="if(this.value < 0){this.value = 0}" class="form-control" style="width:100px;display:unset;"> 元
                                &nbsp;
                                <!--                                给上上级-->
                                <!--                                <input type="number" step="1" name="collage_money_d" value="" placeholder="" onchange="if(this.value < 0){this.value = 0}" onclick="if(this.value < 0){this.value = 0}" class="form-control" style="width:100px;display:unset;"> 元-->
                               团长收益
                                <input type="number" step="1" name="tuanzhang_money" value="" placeholder="" onchange="if(this.value < 0){this.value = 0}" onclick="if(this.value < 0){this.value = 0}" class="form-control" style="width:100px;display:unset;"> 元
                                &nbsp;                           

						   </div>
                        </div>
                        <div class="form-group">
                            <label class="col-md-3 control-label">标题</label>
                            <div class="col-md-9">
                                <input type="text" name="title" id="title" value="" class="form-control">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-md-3 control-label">缩略图</label>
                            <div class="col-md-9">
                                <input type="file" id="thumb" name="thumb" accept="image/png,image/jpg,image/gif,image/JPEG">
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-md-3 control-label">轮播图</label>
                            <div class="col-md-9">
                                <div class="moreImgUpload">
                                    <p class="btn green">添加图片</p>
                                    <input type="file" id="file" name="img" multiple accept="image/png,image/jpg,image/gif,image/JPEG">
                                </div>
                                <div id="imgBox"></div>
                                <div id="imgInput" style="display:none;"></div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-md-3 control-label">金额</label>
                            <div class="col-md-9">
                                <input type="number" name="money" id="money" value="0" step="0.01" onchange="if(this.value < 0){this.value = 0}" onclick="if(this.value < 0){this.value = 0}" class="form-control" style="width:100px;display:unset;">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-md-3 control-label">原价</label>
                            <div class="col-md-9">
                                <input type="number" name="ymoney" id="ymoney" value="0" step="0.01" onchange="if(this.value < 0){this.value = 0}" onclick="if(this.value < 0){this.value = 0}" class="form-control" style="width:100px;display:unset;">
                            </div>
                        </div>
						                        <div class="form-group">
                            <label class="col-md-3 control-label">成本价</label>
                            <div class="col-md-9">
                                <input type="number" name="cbmoney" id="cbmoney" value="0" step="0.01" onchange="if(this.value < 0){this.value = 0}" onclick="if(this.value < 0){this.value = 0}" class="form-control" style="width:100px;display:unset;">
                            </div>
                        </div>
						
						
									<div class="form-group">
                            <label class="col-md-3 control-label">转卖价</label>
                            <div class="col-md-9">
						        <input type="number" step="1" name="zhuanmai_money"  id="zhuanmai_money"  value="0" placeholder="" onchange="if(this.value < 0){this.value = 0}" onclick="if(this.value < 0){this.value = 0}" class="form-control" style="width:100px;display:unset;"> 元
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-md-3 control-label">销量</label>
                            <div class="col-md-9">
                                <input type="number" name="sales" id="sales" value="0" step="1" onchange="if(this.value < 0){this.value = 0}" onclick="if(this.value < 0){this.value = 0}" class="form-control" style="width:100px;display:unset;">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-md-3 control-label">购买须知</label>
                            <div class="col-md-9">
                                <textarea name="notice" class="form-control" style="width: 500px;height:100px;"></textarea>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-md-3 control-label">内容</label>
                            <div class="col-md-9">
                                <textarea name="content" id="content" style="height:500px;"></textarea>
                            </div>
                        </div>
                    </div>
                    <div class="form-actions">
                        <div class="row">
                            <div class="col-md-offset-3 col-md-9">
                                <span id="submit" class="btn green">添加</span>
                                <a href="javascript:;" onclick="javascript:history.back(-1);" class="btn red">返回</a>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<script>
    $('#thumb').fileinput({
        showUpload: false,
        showRemove: false,
        language: 'zh',
        maxFileCount: 1,
        showCaption: false,
        allowedFileExtensions: ['jpg', 'png', 'gif', 'jpeg'],
        maxFileSize: 261120,
        previewFileIcon: "<i class='glyphicon glyphicon-king'></i>"
    });

    UE.getEditor('content');

    imgUpload({
        inputId:'file', //input框id
        imgBox:'imgBox', //图片容器id
        buttonId:'', //提交按钮id
        upUrl:'{:url("ajax_img")}',  //提交地址
        data:'file', //参数名
        num:"20"//上传个数
    });

    $("#submit").click(function(){
        $("#submit").attr({"disabled":"disabled"});

        var fd = new FormData();
        for(var i = 0; i < imgFile.length; i++) {
            fd.append("images[]", imgFile[i]);
        }
        submitPicture('{:url("ajax_img")}',fd);
    });
</script>